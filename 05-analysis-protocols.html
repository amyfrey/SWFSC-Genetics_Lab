<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="This is a living lab document for the Marine Mammal and Marine Turtle Genetics Programs at Southwest Fisheries Science Center">

<title>SWFSC Genetics Lab - Analysis Protocols</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-onboarding.html" rel="next">
<link href="./NGS_SOPs.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-analysis-protocols.html">Analysis Protocols</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SWFSC Genetics Lab</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/amyfrey/SWFSC-Genetics_Lab" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mmtd-archive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Marine Mammal and Turtle Archive</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./current-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Current Projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./current-marine-turtle-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Current Marine Turtle Projects</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./current-marine-mammal-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Current Marine Mammal Projects</strong></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Communication</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./standard-operating-procedures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Standard Operating Procedures (SOP's)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./General-Lab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Lab (SOP’s)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pre_PCR-Lab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pre-PCR Lab (SOP’s)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NGS_SOPs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Next Generation Sequencing (NGS) SOP’s</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-analysis-protocols.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Analysis Protocols</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-onboarding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Onboarding</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#gtseq-analysis-protocols" id="toc-gtseq-analysis-protocols" class="nav-link active" data-scroll-target="#gtseq-analysis-protocols">GTseq Analysis protocols<br>
  </a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/amyfrey/SWFSC-Genetics_Lab/edit/main/05-analysis-protocols.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/amyfrey/SWFSC-Genetics_Lab/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis Protocols</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This section provides a place for people to discribe and link any github pages or scripts that they would like to share with the group.<br>
</p>
<section id="gtseq-analysis-protocols" class="level2">
<h2 class="anchored" data-anchor-id="gtseq-analysis-protocols">GTseq Analysis protocols<br>
</h2>
<p><u><em>provided by A. Frey</em></u><br>
</p>
<p>This is a description of the analysis workflow that I am currently using for fastq files generated from GTseq library prep. The GTseq panel that I am using also includes microsatellite loci, step<br>
</p>
<p><strong>Step One</strong>- Creating Directories, running fastqc, Trimming <em>filename</em>.fastq.gz, running fastqc on trimmed, generating <em>filename</em>.sam, <em>filename</em>.bam files, extracting microsatellite reads for MEGASAT, compressing <em>filename</em>.sam file for Microhaplot<br>
<u><em>Description</em></u>:<br>
This step is currently done on Ahi our legacy HPC, in the near future these scripts will need to be adjusted.<br>
<em>Workflow</em>:<br>
1. open create_directories.sh, edit the following variables in the script: <em>run</em>, <em>sp(species)</em>, <em>project</em>, and <em>user</em> information<br>
2. run create_directories.sh<br>
3. transfer <em>.fastq.gz to appropriate directory<br>
4. open map2ref.sh, edit the following variables in the script: </em>run<em>, </em>sp(species)<em>, </em>project<em>, and </em>user* information, additionally, edit the location for ref files<br>
5. verify that the ref files are in the correct location<br>
6. verify that fastq.gz files have the following format *labID_sample#_L001_R1_001.fastq.gz<em><br>
7. run map2ref.sh <u><em>inputs:</em></u>:<br>
- </em>filename<em>.fastq.gz<br>
- </em>ref<em>.fasta, file containing the sequence for each locus in panel<br>
- </em>msat_primerF<em>.txt, file containing msat forward primer<br>
- adaptorGT.fasta, contains illumina index adapters used in primer design<br>
<u><em>outputs:</em></u> - fastqc file for each raw fastq<br>
- fastqc file for each trimmed fastq<br>
- readcounts.txt containing raw read count for each fastq<br>
- trimmed_readcounts.txt containg read counts remaining after quality trimming<br>
- mapped_readcounts.txt containing # of reads that aligned to the ref.fasta<br>
- msat_readcounts.txt, contain the # of reads that contain any of the forward primer for microsatellite loci<br>
- a depth folder with a </em>labID<em>.coverage file for each fastq, has read counts for each locus in ref.fasta<br>
- tar.gz file with the </em>labID*_mapped2ref.sam files for each fastq<br>
<u><em>link to github scripts:</em></u> - <a href="https://github.com/amyfrey/GTseq/blob/main/create_directories.sh" class="uri">https://github.com/amyfrey/GTseq/blob/main/create_directories.sh</a><br>
- <a href="https://github.com/amyfrey/GTseq/blob/main/map2ref.sh" class="uri">https://github.com/amyfrey/GTseq/blob/main/map2ref.sh</a><br>
- <a href="https://github.com/amyfrey/GTseq/blob/main/ref/DcGTseqPanel_205_112122.fasta" class="uri">https://github.com/amyfrey/GTseq/blob/main/ref/DcGTseqPanel_205_112122.fasta</a><br>
- <a href="https://github.com/amyfrey/GTseq/blob/main/ref/dc_msat_primerF.txt" class="uri">https://github.com/amyfrey/GTseq/blob/main/ref/dc_msat_primerF.txt</a><br>
- <a href="https://github.com/amyfrey/GTseq/blob/main/ref/adaptorGT.fasta" class="uri">https://github.com/amyfrey/GTseq/blob/main/ref/adaptorGT.fasta</a><br>
</p>
<p><strong>Step Two-</strong> Reviewing the coverage for the run<br>
<u><em>Description</em></u>:<br>
The purpose of this script is to get a general idea how the coverage looks across the entire run as well as for the individual loci and samples.<br>
<u><em>inputs:</em></u>:<br>
- sampleinfo.txt, with the following column headers Lab_ID, Plate_ID, Well_ID, Sample_ID this file is something that you will have to make.<br>
- readcounts.txt containing raw read count for each fastq<br>
- trimmed_readcounts.txt containg read counts remaining after quality trimming<br>
- mapped_readcounts.txt containing # of reads that aligned to the ref.fasta<br>
- msat_readcounts.txt, contain the # of reads that contain any of the forward primer for microsatellite loci<br>
- a depth folder with a <em>labID</em>.coverage file for each fastq, has read counts for each locus in ref.fasta<br>
- list of loci as columns(all in one row, with first column called Lab_ID, and last column prop_loci_&gt;10), example of format shown in dc205_list of loci.txt - list of loci as rows (all in one row, with first row called Locus_ID), example of format shown in loci.txt <u><em>outputs:</em></u><br>
- coveragesummary.pdf<br>
<u><em>link to github scripts:</em></u><br>
- <a href="https://github.com/amyfrey/GTseq/blob/main/run_coverage_review.r" class="uri">https://github.com/amyfrey/GTseq/blob/main/run_coverage_review.r</a></p>
<p><strong>Step Three- Generating a .vcf file for Microhaplot</strong> <u><em>Description</em></u>:<br>
The varient caller that is currently being used for this step is freebayes. After freebayes is run, it is important to clean up the .vcf file before moving on to the next step. That is currently done with vcftools, if I known list of varients exists it is easy use the –exclude-positions option, after creating a list of varients that you want to remove from the .vcf file. <u><em>inputs:</em></u><br>
- freebayes requires <em>filename</em>.bam files, and a list of <em>filename</em>.bam files. Our practice at this step is to use the pdf above to identify individuals to not include in the varient calling analysis<br>
- vcftools –exclude-positions requires a vcf file, as well as a text file that lists the varients to remove.<br>
<u><em>outputs:</em></u><br>
- <em>filename</em>.vcf<br>
- <em>filename</em>_targetloci_recode.vcf<br>
<u><em>commands used:</em></u><br>
- freebayes-parallel &lt;(fasta_generate_regions.py /home/afrey/gtseq/ref/DcGTseqPanel_205_112122.fasta.fai 200) 6 -f /home/afrey/gtseq/ref/DcGTseqPanel_205_112122.fasta -L ./bamlist_100423.txt –haplotype-length 0 -kwVa –no-mnps –no-complex –min-coverage 10 –use-best-n-alleles 4 –min-alternate-count 5 –min-alternate-fraction 0.3 &gt; Dcor_mex_fem_DcPanel_205_100423.vcf<br>
- vcftools –vcf ./Dcor_gtseq_fem_DcPanel205_053123.vcf –out ./Dcor_gtseq_fem_DcPanel205.targetSNPs –exclude-positions ./non.target.locs.to.remove2.txt –recode –recode-INFO-all<br>
</p>
<p><strong>Step Four- Running Microhaplot</strong><br>
<u><em>Description</em></u>:<br>
</p>
<p><u><em>inputs:</em></u><br>
- <em>filename</em>.sam files - <em>filename</em>_targetloci_recode.vcf<br>
<u><em>outputs:</em></u><br>
</p>
<p><u><em>link to manual:</em></u><br>
- https://ngthomas.github.io/microhaplot/</p>
<p><strong>Step Five- Microsatellite Analysis using MEGASAT</strong><br>
<u><em>Description</em></u>:<br>
This step is only necessary if there are microsatellite loci in your panel. If so the software we are using is a perl script called MEGASAT. <u><em>inputs:</em></u><br>
- <em>labID</em>_msat.fastq (generated in step one above) - MEGASAT_Genotype.pl - <em>primer-input</em>.txt, see documentation for formate<br>
<u><em>outputs:</em></u><br>
- genotype.txt<br>
- number_Discarded.txt<br>
- Number_Sorted.txt<br>
- Number_Trimmed.txt<br>
- Ratios_Threshold_.txt<br>
- directory: Discarded<br>
- directory: length_distribution<br>
- directory: Sorted<br>
- directory: Trimmed<br>
<u><em>link to github:</em></u><br>
- <a href="https://github.com/beiko-lab/MEGASAT" class="uri">https://github.com/beiko-lab/MEGASAT</a></p>
<p><strong>Step Six- Importing Genotypes into SWFSC Genotypes Database</strong> <u><em>Description</em></u>:<br>
This step is still in process. Stay tuned for updates. <u><em>inputs:</em></u><br>
<u><em>outputs:</em></u><br>
<u><em>link to scripts:</em></u><br>
</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./NGS_SOPs.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Next Generation Sequencing (NGS) SOP’s</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-onboarding.html" class="pagination-link">
        <span class="nav-page-text">Onboarding</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><a href="https://www.fisheries.noaa.gov/about/marine-mammal-and-turtle-division-southwest-fisheries-science-center">SWFSC Marine Mammal and Turtle Division</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>